<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>coniii.samplers module &#8212; ConIII 1.1.9 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="coniii.utils module" href="coniii.utils.html" />
    <link rel="prev" title="coniii.solvers module" href="coniii.solvers.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-coniii.samplers">
<span id="coniii-samplers-module"></span><h1>coniii.samplers module<a class="headerlink" href="#module-coniii.samplers" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="coniii.samplers.HamiltonianMC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">HamiltonianMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leapfrogN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nCpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.HamiltonianMC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#coniii.samplers.Sampler" title="coniii.samplers.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.HamiltonianMC.generate_sample">
<span class="sig-name descname"><span class="pre">generate_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nSamples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBurn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.HamiltonianMC.generate_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate nSamples from this Hamiltonian starting from random initial conditions
from each sample.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.HamiltonianMC.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBurn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveHistory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.HamiltonianMC.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a single sample by MC sampling from this Hamiltonian. Slow method</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coniii.samplers.Heisenberg3DSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">Heisenberg3DSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_sample</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Heisenberg3DSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#coniii.samplers.Sampler" title="coniii.samplers.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<p>Simple MC Sampling from Heisenberg model with a lot of helpful functions.</p>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this heading">¶</a></h2>
<p>generate_sample()
equilibrate_samples()
sample_metropolis()
sample_energy_min()</p>
<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Heisenberg3DSampler.equilibrate_samples">
<span class="sig-name descname"><span class="pre">equilibrate_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nCpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Heisenberg3DSampler.equilibrate_samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Heisenberg3DSampler.generate_sample">
<span class="sig-name descname"><span class="pre">generate_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nSamples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Heisenberg3DSampler.generate_sample" title="Permalink to this definition">¶</a></dt>
<dd><section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading">¶</a></h3>
<p>sample_size : int</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Heisenberg3DSampler.grad_E">
<span class="sig-name descname"><span class="pre">grad_E</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Heisenberg3DSampler.grad_E" title="Permalink to this definition">¶</a></dt>
<dd><p>Gradient wrt theta and phi.</p>
<section id="id1">
<h3>Parameters<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>X<span class="classifier">ndarray</span></dt><dd><p>with dims (nSpins,2) with angles theta and phi</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Heisenberg3DSampler.sample_energy_min">
<span class="sig-name descname"><span class="pre">sample_energy_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nFixed=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng=RandomState(MT19937)</span> <span class="pre">at</span> <span class="pre">0x7FEC0FEEF340</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialState=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method='powell'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Heisenberg3DSampler.sample_energy_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Find local energy minimum given state in angular form. Angular representation
makes it easy to be explicit about constraints on the vectors.</p>
<section id="id2">
<h3>Parameters<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>initialState<span class="classifier">ndarray,None</span></dt><dd><p>n_samples x n_features x 2</p>
</dd>
<dt>nFixed<span class="classifier">int,0</span></dt><dd><p>Number of vectors that are fixed.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Heisenberg3DSampler.sample_metropolis">
<span class="sig-name descname"><span class="pre">sample_metropolis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oldState</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Heisenberg3DSampler.sample_metropolis" title="Permalink to this definition">¶</a></dt>
<dd><section id="id3">
<h3>Parameters<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>s<span class="classifier">ndarray</span></dt><dd><p>State to perturb randomly.</p>
</dd>
<dt>energy<span class="classifier">float</span></dt><dd><p>Energy of configuration.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Heisenberg3DSampler.sample_nearby_sample">
<span class="sig-name descname"><span class="pre">sample_nearby_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Heisenberg3DSampler.sample_nearby_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly move given state around for new metropolis sample.  Question is
whether it is more efficient to push only one of the many vectors around or all of
them simultaneously.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Heisenberg3DSampler.sample_nearby_vector">
<span class="sig-name descname"><span class="pre">sample_nearby_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">otheta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ophi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Heisenberg3DSampler.sample_nearby_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample random vector that is nearby. It is important how you choose the width sigma.
NOTE: code might be simplified by using arctan2 instead of arctan</p>
<section id="id4">
<h3>Parameters<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>v<span class="classifier">ndarray</span></dt><dd><p>xyz vector about which to sample random vectors</p>
</dd>
<dt>nSamples<span class="classifier">int,1</span></dt><dd><p>number of random samples</p>
</dd>
<dt>otheta<span class="classifier">float,None</span></dt><dd><p>polar angle for v</p>
</dd>
<dt>ophi<span class="classifier">float,None</span></dt><dd><p>azimuthal angle for v</p>
</dd>
<dt>sigma<span class="classifier">float,.1</span></dt><dd><p>width of Gaussian about v</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Heisenberg3DSampler.to_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Heisenberg3DSampler.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function taking 3d array of of samples and arranging them into n x
3 arrays in a dictionary.</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coniii.samplers.Metropolis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">Metropolis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Metropolis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#coniii.samplers.Sampler" title="coniii.samplers.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Metropolis.generate_cond_sample_boost">
<span class="sig-name descname"><span class="pre">generate_cond_sample_boost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systematic_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Metropolis.generate_cond_sample_boost" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate samples from conditional distribution (while a subset of the spins are
held fixed).</p>
<section id="id5">
<h2>Parameters<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h2>
<p>sample_size : int
fixed_subset : list of duples</p>
<blockquote>
<div><p>Each duple is the index of the spin and the value to fix it at. These should
be ordered by spin index.</p>
</div></blockquote>
<dl class="simple">
<dt>burn_in<span class="classifier">int, 1000</span></dt><dd><p>Burn in.</p>
</dd>
</dl>
<p>n_iters : int, 1000
initial_sample : ndarray, None</p>
<blockquote>
<div><p>Option to set initial random sample.</p>
</div></blockquote>
<dl class="simple">
<dt>systematic_iter<span class="classifier">bool, False</span></dt><dd><p>Iterate through spins systematically instead of choosing them randomly.</p>
</dd>
<dt>parallel<span class="classifier">bool, True</span></dt><dd><p>If True, use parallelized routine.</p>
</dd>
</dl>
</section>
<section id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>ndarray</dt><dd><p>Samples from distribution.</p>
</dd>
<dt>ndarray</dt><dd><p>Energy of each sample.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Metropolis.generate_cond_sample_py">
<span class="sig-name descname"><span class="pre">generate_cond_sample_py</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systematic_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Metropolis.generate_cond_sample_py" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate samples from conditional distribution (while a subset of the spins are
held fixed).  Samples are generated in parallel.</p>
<p>NOTE: There is a bug with multiprocess where many calls to the parallel sampling
routine in a row leads to increasingly slow evaluation of the code.</p>
<section id="id6">
<h2>Parameters<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h2>
<p>sample_size : int
fixed_subset : list of duples</p>
<blockquote>
<div><p>Each duple is the index of the spin and the value to fix it at. These should
be ordered by spin index.</p>
</div></blockquote>
<dl class="simple">
<dt>burn_in<span class="classifier">int, 1000</span></dt><dd><p>Burn in.</p>
</dd>
</dl>
<p>n_iters : int, 1000
initial_sample : ndarray, None</p>
<blockquote>
<div><p>Option to set initial random sample.</p>
</div></blockquote>
<dl class="simple">
<dt>systematic_iter<span class="classifier">bool, False</span></dt><dd><p>Iterate through spins systematically instead of choosing them randomly.</p>
</dd>
<dt>parallel<span class="classifier">bool, False</span></dt><dd><p>If True, use parallelized routine.</p>
</dd>
</dl>
</section>
<section id="id7">
<h2>Returns<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>ndarray</dt><dd><p>Samples from distribution.</p>
</dd>
<dt>ndarray</dt><dd><p>Energy of each sample.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Metropolis.generate_sample_boost">
<span class="sig-name descname"><span class="pre">generate_sample_boost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systematic_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Metropolis.generate_sample_boost" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate Metropolis samples using C++ and boost.</p>
<section id="id8">
<h2>Parameters<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>sample_size<span class="classifier">int</span></dt><dd><p>Number of samples.</p>
</dd>
<dt>n_iters<span class="classifier">int, 1000</span></dt><dd><p>Number of Metropolis iterations between samples.</p>
</dd>
<dt>burn_in<span class="classifier">int, None</span></dt><dd><p>If not set, will be the same value as n_iters.</p>
</dd>
<dt>systematic_iter<span class="classifier">bool, False</span></dt><dd><p>If True, iterate through each element of system by increment index by one.</p>
</dd>
</dl>
</section>
<section id="id9">
<h2>Returns<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>ndarray, optional</dt><dd><p>Saved array of energies at each sampling step.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Metropolis.generate_sample_parallel_boost">
<span class="sig-name descname"><span class="pre">generate_sample_parallel_boost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systematic_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Metropolis.generate_sample_parallel_boost" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate samples in parallel. Each replica in self._samples runs on its own thread
and a sample is generated every n_iters.</p>
<p>In order to control the random number generator, we pass in seeds that are samples
from the class instance’s rng.</p>
<section id="id10">
<h2>Parameters<a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>sample_size<span class="classifier">int</span></dt><dd><p>Number of samples.</p>
</dd>
<dt>n_iters<span class="classifier">int, 1000</span></dt><dd><p>Number of iterations between taking a random sample.</p>
</dd>
<dt>burn_in<span class="classifier">int, None</span></dt><dd><p>If None, n_iters is used.</p>
</dd>
<dt>systematic_iter<span class="classifier">bool, False</span></dt><dd><p>If True, iterate through spins systematically instead of choosing them
randomly.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Metropolis.generate_sample_parallel_py">
<span class="sig-name descname"><span class="pre">generate_sample_parallel_py</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systematic_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Metropolis.generate_sample_parallel_py" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate samples in parallel. Each replica in self._samples runs on its own thread
and a sample is generated every n_iters.</p>
<p>In order to control the random number generator, we pass in seeds that are samples
from the class instance’s rng.</p>
<section id="id11">
<h2>Parameters<a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>sample_size<span class="classifier">int</span></dt><dd><p>Number of samples.</p>
</dd>
<dt>n_iters<span class="classifier">int, 1000</span></dt><dd><p>Number of iterations between taking a random sample.</p>
</dd>
<dt>burn_in<span class="classifier">int, None</span></dt><dd><p>If None, n_iters is used.</p>
</dd>
<dt>initial_sample<span class="classifier">ndarray, None</span></dt><dd><p>Starting set of replicas otherwise self._samples is used.</p>
</dd>
<dt>systematic_iter<span class="classifier">bool, False</span></dt><dd><p>If True, iterate through spins systematically instead of choosing them
randomly.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Metropolis.generate_sample_py">
<span class="sig-name descname"><span class="pre">generate_sample_py</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systematic_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveHistory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Metropolis.generate_sample_py" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate Metropolis samples using a for loop.</p>
<section id="id12">
<h2>Parameters<a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>sample_size<span class="classifier">int</span></dt><dd><p>Number of samples.</p>
</dd>
<dt>n_iters<span class="classifier">int, 1000</span></dt><dd><p>Number of iterations to run the sampler floor.</p>
</dd>
<dt>burn_in<span class="classifier">int, None</span></dt><dd><p>If None, n_iters is used.</p>
</dd>
<dt>systematic_iter<span class="classifier">bool, False</span></dt><dd><p>If True, iterate through each element of system by increment index by one.</p>
</dd>
<dt>saveHistory<span class="classifier">bool, False</span></dt><dd><p>If True, also save the energy of each sample at each sampling step.</p>
</dd>
<dt>initial_sample<span class="classifier">ndarray, None</span></dt><dd><p>Start with this sample (i.e. to avoid warming up). Otherwise, self._samples is
the initial sample.</p>
</dd>
</dl>
</section>
<section id="id13">
<h2>Returns<a class="headerlink" href="#id13" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>ndarray, optional</dt><dd><p>Saved array of energies at each sampling step.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Metropolis.random_sample">
<span class="sig-name descname"><span class="pre">random_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Metropolis.random_sample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Metropolis.sample_metropolis">
<span class="sig-name descname"><span class="pre">sample_metropolis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_site</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Metropolis.sample_metropolis" title="Permalink to this definition">¶</a></dt>
<dd><p>Metropolis sampling given an arbitrary energy function.</p>
<section id="id14">
<h2>Parameters<a class="headerlink" href="#id14" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>sample0<span class="classifier">ndarray</span></dt><dd><p>Sample to start with. Passed by ref and changed.</p>
</dd>
<dt>E0<span class="classifier">ndarray</span></dt><dd><p>Initial energy of state.</p>
</dd>
<dt>rng<span class="classifier">np.random.RandomState</span></dt><dd><p>Random number generator.</p>
</dd>
<dt>flip_site<span class="classifier">int</span></dt><dd><p>Site to flip.</p>
</dd>
<dt>calc_e<span class="classifier">function</span></dt><dd><p>If another function to calculate energy should be used</p>
</dd>
</dl>
</section>
<section id="id15">
<h2>Returns<a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>float</dt><dd><p>delta energy.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Metropolis.update_parameters">
<span class="sig-name descname"><span class="pre">update_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Metropolis.update_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coniii.samplers.ParallelTempering">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">ParallelTempering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_replicas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Tbds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">3.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replica_burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep_ex_burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.ParallelTempering" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#coniii.samplers.Sampler" title="coniii.samplers.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.ParallelTempering.burn_and_exchange">
<span class="sig-name descname"><span class="pre">burn_and_exchange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pool</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.ParallelTempering.burn_and_exchange" title="Permalink to this definition">¶</a></dt>
<dd><section id="id16">
<h2>Parameters<a class="headerlink" href="#id16" title="Permalink to this heading">¶</a></h2>
<p>pool : mp.multiprocess.Pool</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.ParallelTempering.burn_in_replicas">
<span class="sig-name descname"><span class="pre">burn_in_replicas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">close_pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.ParallelTempering.burn_in_replicas" title="Permalink to this definition">¶</a></dt>
<dd><p>Run each replica separately.</p>
<section id="id17">
<h2>Parameters<a class="headerlink" href="#id17" title="Permalink to this heading">¶</a></h2>
<p>pool : multiprocess.Pool, None
close_pool : bool, True</p>
<blockquote>
<div><p>If True, call pool.close() at end.</p>
</div></blockquote>
<dl class="simple">
<dt>n_iters<span class="classifier">int, None</span></dt><dd><p>Default value is self.replicaBurnin.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.ParallelTempering.generate_sample">
<span class="sig-name descname"><span class="pre">generate_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_exchange_trajectory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.ParallelTempering.generate_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Burn in, run replica exchange simulation, then sample.</p>
<section id="id18">
<h2>Parameters<a class="headerlink" href="#id18" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>sample_size<span class="classifier">int</span></dt><dd><p>Number of samples to take for each replica.</p>
</dd>
<dt>save_exchange_trajectory<span class="classifier">bool, False</span></dt><dd><p>If True, keep track of the location of each replica in beta space and return
the history.</p>
</dd>
</dl>
</section>
<section id="id19">
<h2>Returns<a class="headerlink" href="#id19" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>ndarray, optional</dt><dd><p>Trajectory of each replica through beta space. Each row is tells where each
index is located in beta space.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.ParallelTempering.initialize_beta">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_replicas</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.ParallelTempering.initialize_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Use linear interpolation of temperature range.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.ParallelTempering.iterate_beta">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">iterate_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptance_ratio</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.ParallelTempering.iterate_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply algorithm from Hukushima but reversed to maintain one replica at T=1.</p>
<section id="id20">
<h2>Parameters<a class="headerlink" href="#id20" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>beta<span class="classifier">ndarray</span></dt><dd><p>Inverse temperature.</p>
</dd>
<dt>acceptance_ratio<span class="classifier">ndarray</span></dt><dd><p>Estimate of acceptance ratio.</p>
</dd>
</dl>
</section>
<section id="id21">
<h2>Returns<a class="headerlink" href="#id21" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>ndarray</dt><dd><p>New beta.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.ParallelTempering.optimize_beta">
<span class="sig-name descname"><span class="pre">optimize_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.ParallelTempering.optimize_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Find suitable temperature range for replicas. Sets self.beta.</p>
<section id="id22">
<h2>Parameters<a class="headerlink" href="#id22" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>n_samples<span class="classifier">int</span></dt><dd><p>Number of samples to use to estimate acceptance ratio. Acceptance ratio is
estimated as the average of these samples.</p>
</dd>
<dt>n_iters<span class="classifier">int</span></dt><dd><p>Number of sampling iterations for each replica.</p>
</dd>
<dt>tol<span class="classifier">float, .1</span></dt><dd><p>Average change in beta to reach before stopping.</p>
</dd>
<dt>max_iter<span class="classifier">int, 10</span></dt><dd><p>Number of times to iterate algorithm for beta. Each iteration involves
sampling from replicas.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.ParallelTempering.setup_replicas">
<span class="sig-name descname"><span class="pre">setup_replicas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.ParallelTempering.setup_replicas" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a set of replicas at different temperatures using the Metropolis
algorithm and optimize the temperatures. Replicas are burned in and ready to
sample.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.ParallelTempering.update_replica_parameters">
<span class="sig-name descname"><span class="pre">update_replica_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.ParallelTempering.update_replica_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Update parameters for each replica. Remember that the parameters include the
factor of beta.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coniii.samplers.Potts3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">Potts3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Potts3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#coniii.samplers.Metropolis" title="coniii.samplers.Metropolis"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metropolis</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Potts3.generate_sample_parallel_boost">
<span class="sig-name descname"><span class="pre">generate_sample_parallel_boost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">systematic_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Potts3.generate_sample_parallel_boost" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate samples in parallel. Each replica in self._samples runs on its own thread
and a sample is generated every n_iters.</p>
<p>In order to control the random number generator, we pass in seeds that are samples
from the class instance’s rng.</p>
<section id="id23">
<h2>Parameters<a class="headerlink" href="#id23" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>sample_size<span class="classifier">int</span></dt><dd><p>Number of samples.</p>
</dd>
<dt>n_iters<span class="classifier">int, 1000</span></dt><dd><p>Number of iterations between taking a random sample.</p>
</dd>
<dt>burn_in<span class="classifier">int, None</span></dt><dd><p>If None, n_iters is used.</p>
</dd>
<dt>systematic_iter<span class="classifier">bool, False</span></dt><dd><p>If True, iterate through spins systematically instead of choosing them
randomly.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Potts3.random_sample">
<span class="sig-name descname"><span class="pre">random_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Potts3.random_sample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Potts3.sample_metropolis">
<span class="sig-name descname"><span class="pre">sample_metropolis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_site</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Potts3.sample_metropolis" title="Permalink to this definition">¶</a></dt>
<dd><p>Metropolis sampling given an arbitrary sampling function.</p>
<section id="id24">
<h2>Parameters<a class="headerlink" href="#id24" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>sample0<span class="classifier">ndarray</span></dt><dd><p>Sample to start with. Passed by ref and changed.</p>
</dd>
<dt>E0<span class="classifier">ndarray</span></dt><dd><p>Initial energy of state.</p>
</dd>
<dt>rng<span class="classifier">np.random.RandomState</span></dt><dd><p>Random number generator.</p>
</dd>
<dt>flip_site<span class="classifier">int</span></dt><dd><p>Site to flip.</p>
</dd>
<dt>calc_e<span class="classifier">function</span></dt><dd><p>If another function to calculate energy should be used</p>
</dd>
</dl>
</section>
<section id="id25">
<h2>Returns<a class="headerlink" href="#id25" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>float</dt><dd><p>delta energy.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coniii.samplers.SWIsing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">SWIsing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nCpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.SWIsing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#coniii.samplers.Sampler" title="coniii.samplers.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.SWIsing.generate_sample">
<span class="sig-name descname"><span class="pre">generate_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.SWIsing.generate_sample" title="Permalink to this definition">¶</a></dt>
<dd><section id="id26">
<h2>Parameters<a class="headerlink" href="#id26" title="Permalink to this heading">¶</a></h2>
<p>n_samples
n_iters
initial_state : ndarray,None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.SWIsing.generate_sample_parallel">
<span class="sig-name descname"><span class="pre">generate_sample_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.SWIsing.generate_sample_parallel" title="Permalink to this definition">¶</a></dt>
<dd><section id="id27">
<h2>Parameters<a class="headerlink" href="#id27" title="Permalink to this heading">¶</a></h2>
<p>n_samples
n_iters
initial_state : ndarray,None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.SWIsing.get_clusters">
<span class="sig-name descname"><span class="pre">get_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.SWIsing.get_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a random sample of clusters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.SWIsing.one_step">
<span class="sig-name descname"><span class="pre">one_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.SWIsing.one_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.SWIsing.print_cluster_size">
<span class="sig-name descname"><span class="pre">print_cluster_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.SWIsing.print_cluster_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.SWIsing.randomly_flip_clusters">
<span class="sig-name descname"><span class="pre">randomly_flip_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clusters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.SWIsing.randomly_flip_clusters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coniii.samplers.Sampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">Sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for MCMC sampling.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Sampler.generate_sample">
<span class="sig-name descname"><span class="pre">generate_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Sampler.generate_sample" title="Permalink to this definition">¶</a></dt>
<dd><section id="id28">
<h2>Parameters<a class="headerlink" href="#id28" title="Permalink to this heading">¶</a></h2>
<p>sample_size : int</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Sampler.generate_sample_parallel">
<span class="sig-name descname"><span class="pre">generate_sample_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Sampler.generate_sample_parallel" title="Permalink to this definition">¶</a></dt>
<dd><section id="id29">
<h2>Parameters<a class="headerlink" href="#id29" title="Permalink to this heading">¶</a></h2>
<p>sample_size : int</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Sampler.sample_metropolis">
<span class="sig-name descname"><span class="pre">sample_metropolis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Sampler.sample_metropolis" title="Permalink to this definition">¶</a></dt>
<dd><section id="id30">
<h2>Parameters<a class="headerlink" href="#id30" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>s<span class="classifier">ndarray</span></dt><dd><p>State to perturb randomly.</p>
</dd>
<dt>energy<span class="classifier">float</span></dt><dd><p>Energy of configuration.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.Sampler.update_parameters">
<span class="sig-name descname"><span class="pre">update_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.Sampler.update_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coniii.samplers.WolffIsing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">WolffIsing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.WolffIsing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#coniii.samplers.Sampler" title="coniii.samplers.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.WolffIsing.build_cluster">
<span class="sig-name descname"><span class="pre">build_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialsite</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.WolffIsing.build_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Grow cluster from initial site.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.WolffIsing.find_neighbors">
<span class="sig-name descname"><span class="pre">find_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alreadyMarked</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.WolffIsing.find_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return neighbors of given site that need to be visited excluding sites that
have already been visited.  This is the implementation of the Wolff algorithm for
finding neighbors such that detailed balance is satisfied. I have modified to
include random fields such tha the probability of adding a neighbors depends both
on its coupling with the current site and the neighbor’s magnetic field.</p>
<section id="id31">
<h2>Parameters<a class="headerlink" href="#id31" title="Permalink to this heading">¶</a></h2>
<p>state
site
alreadyMarked</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.WolffIsing.generate_sample">
<span class="sig-name descname"><span class="pre">generate_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samplesize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialSample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_history</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.WolffIsing.generate_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate samples by starting from random initial states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.WolffIsing.generate_sample_parallel">
<span class="sig-name descname"><span class="pre">generate_sample_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samplesize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialSample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.WolffIsing.generate_sample_parallel" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate samples by starting from random or given initial states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.WolffIsing.one_step">
<span class="sig-name descname"><span class="pre">one_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialsite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.WolffIsing.one_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Run one iteration of the Wolff algorithm that involves finding a cluster and
possibly flipping it.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coniii.samplers.WolffIsing.update_parameters">
<span class="sig-name descname"><span class="pre">update_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.WolffIsing.update_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.calc_e">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">calc_e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.calc_e" title="Permalink to this definition">¶</a></dt>
<dd><p>Heisenberg model.</p>
<section id="id32">
<h2>Parameters<a class="headerlink" href="#id32" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>theta<span class="classifier">ndarray</span></dt><dd><p>List of couplings Jij</p>
</dd>
<dt>x<span class="classifier">ndarray</span></dt><dd><p>List of angles (theta_0,phi_0,theta_1,phi_1,…,theta_n,phi_n)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.check_e_logp">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">check_e_logp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.check_e_logp" title="Permalink to this definition">¶</a></dt>
<dd><p>Boltzmann type model with discrete state space should have E propto -logP.
Calculate these quantities for comparison.</p>
<section id="id33">
<h2>Parameters<a class="headerlink" href="#id33" title="Permalink to this heading">¶</a></h2>
<p>sample
calc_e</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.cross">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">cross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.cross" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the cross product of two 3d vectors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.cross_">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">cross_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.cross_" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the cross product of two 3d vectors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.define_jit_cond_calc_e">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">define_jit_cond_calc_e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_subset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.define_jit_cond_calc_e" title="Permalink to this definition">¶</a></dt>
<dd><p>Redefine calc_e to calculate energy and putting back in the fixed spins.</p>
<section id="id34">
<h2>Parameters<a class="headerlink" href="#id34" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>state<span class="classifier">ndarray</span></dt><dd><p>Free spins (not fixed).</p>
</dd>
<dt>theta<span class="classifier">ndarray</span></dt><dd><p>Parameters.</p>
</dd>
</dl>
</section>
<section id="id35">
<h2>Returns<a class="headerlink" href="#id35" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>float</dt><dd><p>Energy of state with fixed spins.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.grad_e">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">grad_e</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.grad_e" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivatives wrt the angles of the spins.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.grad_e_theta">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">grad_e_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.grad_e_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivatives wrt the couplings theta.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.iter_cluster">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">iter_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.iter_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Cycle through all spins to get clusters.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.iterate_neighbors">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">iterate_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expdJ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.iterate_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through all neighbors of a particular site and see if a bond should be
formed between them.</p>
<section id="id36">
<h2>Parameters<a class="headerlink" href="#id36" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>n<span class="classifier">int</span></dt><dd><p>System size.</p>
</dd>
<dt>ix<span class="classifier">ndarray of bool</span></dt><dd><p>Indices of sites that have already been visited.</p>
</dd>
<dt>expdJ<span class="classifier">ndarray</span></dt><dd><p>np.exp( -2*state[:,None]*state[None,:]*J )</p>
</dd>
<dt>r<span class="classifier">ndarray</span></dt><dd><p>Array of random numbers.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.jit_sample">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">jit_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBurn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leapfrogN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randNormal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randUnif</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.jit_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a single sample by MC sampling from this Hamiltonian.</p>
<section id="id37">
<h2>Parameters<a class="headerlink" href="#id37" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>theta<span class="classifier">ndarray</span></dt><dd><p>Parameters</p>
</dd>
<dt>x0<span class="classifier">ndarray</span></dt><dd><p>Sample</p>
</dd>
</dl>
<p>nBurn : int
dt : float
leapfrogN : int
randNormal : ndarray</p>
<blockquote>
<div><p>nBurn x ndim</p>
</div></blockquote>
<dl class="simple">
<dt>randUnif<span class="classifier">ndarray</span></dt><dd><p>nBurn</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.jit_sample_nearby_vector">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">jit_sample_nearby_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rseed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nSamples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">otheta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ophi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.jit_sample_nearby_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.pairwise_prod">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">pairwise_prod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.pairwise_prod" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.sample_bonds">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">sample_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.sample_bonds" title="Permalink to this definition">¶</a></dt>
<dd><section id="id38">
<h2>Parameters<a class="headerlink" href="#id38" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>p<span class="classifier">ndarray</span></dt><dd><p>Probability of bond formation.</p>
</dd>
<dt>r<span class="classifier">ndarray</span></dt><dd><p>Random numbers.</p>
</dd>
</dl>
<p>state
J</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.sample_ising">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">sample_ising</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multipliers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_sample_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.sample_ising" title="Permalink to this definition">¶</a></dt>
<dd><p>Easy way to Metropolis sample from Ising model.</p>
<section id="id39">
<h2>Parameters<a class="headerlink" href="#id39" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>multipliers<span class="classifier">ndarray or twople</span></dt><dd><p>N individual fields followed by N(N-1)/2 pairwise couplings.</p>
</dd>
<dt>n_samples<span class="classifier">int</span></dt><dd><p>Number of samples to take.</p>
</dd>
<dt>seed<span class="classifier">int, None</span></dt><dd><p>Random number generator seed.</p>
</dd>
<dt>parallel<span class="classifier">bool, True</span></dt><dd><p>If True, use parallelized sampling routine.</p>
</dd>
<dt>generate_sample_kw<span class="classifier">dict, {}</span></dt><dd><dl class="simple">
<dt>Any extra arguments to send into Metropolis sampler. Default args are</dt><dd><p>n_iters=1000
systematic_iter=False
saveHistory=False
initial_sample=None</p>
</dd>
</dl>
</dd>
</dl>
</section>
<section id="id40">
<h2>Returns<a class="headerlink" href="#id40" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>ndarray</dt><dd><p>Matrix of dimensions (n_samples, n).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coniii.samplers.spec_cluster">
<span class="sig-prename descclassname"><span class="pre">coniii.samplers.</span></span><span class="sig-name descname"><span class="pre">spec_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coniii.samplers.spec_cluster" title="Permalink to this definition">¶</a></dt>
<dd><section id="id41">
<h2>Parameters<a class="headerlink" href="#id41" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>L<span class="classifier">ndarray</span></dt><dd><p>Graph Laplacian</p>
</dd>
</dl>
</section>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">ConIII</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="coniii.enumerate.html">coniii.enumerate module</a></li>
<li class="toctree-l1"><a class="reference internal" href="coniii.enumerate_potts.html">coniii.enumerate_potts module</a></li>
<li class="toctree-l1"><a class="reference internal" href="coniii.ising.html">coniii.ising package</a></li>
<li class="toctree-l1"><a class="reference internal" href="coniii.solvers.html">coniii.solvers module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">coniii.samplers module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.HamiltonianMC"><code class="docutils literal notranslate"><span class="pre">HamiltonianMC</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.Heisenberg3DSampler"><code class="docutils literal notranslate"><span class="pre">Heisenberg3DSampler</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.Metropolis"><code class="docutils literal notranslate"><span class="pre">Metropolis</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.ParallelTempering"><code class="docutils literal notranslate"><span class="pre">ParallelTempering</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.Potts3"><code class="docutils literal notranslate"><span class="pre">Potts3</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.SWIsing"><code class="docutils literal notranslate"><span class="pre">SWIsing</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.Sampler"><code class="docutils literal notranslate"><span class="pre">Sampler</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.WolffIsing"><code class="docutils literal notranslate"><span class="pre">WolffIsing</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.calc_e"><code class="docutils literal notranslate"><span class="pre">calc_e()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.check_e_logp"><code class="docutils literal notranslate"><span class="pre">check_e_logp()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.cross"><code class="docutils literal notranslate"><span class="pre">cross()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.cross_"><code class="docutils literal notranslate"><span class="pre">cross_()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.define_jit_cond_calc_e"><code class="docutils literal notranslate"><span class="pre">define_jit_cond_calc_e()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.grad_e"><code class="docutils literal notranslate"><span class="pre">grad_e()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.grad_e_theta"><code class="docutils literal notranslate"><span class="pre">grad_e_theta()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.iter_cluster"><code class="docutils literal notranslate"><span class="pre">iter_cluster()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.iterate_neighbors"><code class="docutils literal notranslate"><span class="pre">iterate_neighbors()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.jit_sample"><code class="docutils literal notranslate"><span class="pre">jit_sample()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.jit_sample_nearby_vector"><code class="docutils literal notranslate"><span class="pre">jit_sample_nearby_vector()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.pairwise_prod"><code class="docutils literal notranslate"><span class="pre">pairwise_prod()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.sample_bonds"><code class="docutils literal notranslate"><span class="pre">sample_bonds()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.sample_ising"><code class="docutils literal notranslate"><span class="pre">sample_ising()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#coniii.samplers.spec_cluster"><code class="docutils literal notranslate"><span class="pre">spec_cluster()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="coniii.utils.html">coniii.utils module</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="coniii.solvers.html" title="previous chapter">coniii.solvers module</a></li>
      <li>Next: <a href="coniii.utils.html" title="next chapter">coniii.utils module</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Edward D. Lee, Bryan C. Daniels.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/coniii_rst/coniii.samplers.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>